#!/usr/bin/env node

const program = require('commander');
const fs = require('fs');
const orchestrator = require('../index.js');
const pjson = require('../package.json');

const PACKAGE_XML_FILE_NAME = 'package.xml';

program
  .description(pjson.description)
  .version(pjson.version)
  .option('-s, --src [dir]', 'salesforce src directory path [./src]', './src')
  .option('-a, --api-version [version]', 'salesforce API version [39.0]', '39.0')
  .option('-o, --output [dir]', 'salesforce package.xml directory path [./src]', './src')
  .parse(process.argv);

orchestrator(program, console.log)
.then(xmlContent => fs.writeFileSync(program.output + '/' + PACKAGE_XML_FILE_NAME, xmlContent))
.catch(function(err){
  console.log(err);
});